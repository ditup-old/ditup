<%

  var css = [
    '/css/header.css',
    '/css/messages.css'
  ];

  var title = 'messages';
  var headScripts = [];
  var scripts = [];
  session = session || {logged:false, username: null};
  var logged = session.logged === true ? true : false;
  var loggedUser = session.username || null;

%><%
include ./partial/page-top.ejs %><%
include ./partial/header.ejs %>
<section class="page">
  <header><h1>Messages</h1></header>
  <section><ul><% for(msg of lastMessages) {
      let notViewedClass = (msg.viewed === true || msg.from.username === loggedUser) ? '' : ' unseen';
      let otherUser = loggedUser == msg.from.username ? msg.to.username : msg.from.username;
      %><li class="last-user-message<%= notViewedClass %>">
        <a href="/messages/<%= otherUser %>">
          <span class="icon-user msg-other-user"><%= otherUser %></span><span><%= msg.text %></span>
        </a>
      </li><%
    }
    %></ul></section>
  <form method="post" action="">
    <textarea name="message"></textarea>
    <input type="submit" name="send" value="send" />
  </form>
</section>
<% include ./partial/page-bottom.ejs %>
